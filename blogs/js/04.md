---
title: åˆ›å»ºå¯¹è±¡ä¹‹åŸå‹æ¨¡å¼
date: 2021-11-29
categories:
- js
tags:
- åˆ›å»ºå¯¹è±¡
- åŸå‹
---

&emsp;&emsp;æ¯ä¸ªå‡½æ•°éƒ½ä¼šåˆ›å»ºä¸€ä¸ª`prototype` å±æ€§ï¼Œ **è¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«åº”è¯¥ç”±ç‰¹å®šå¼•ç”¨ç±»å‹çš„å®ä¾‹å…±äº«çš„å±æ€§å’Œæ–¹æ³•ã€‚** **å®é™…ä¸Šï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯é€šè¿‡è°ƒç”¨æ„é€ å‡½æ•°åˆ›å»ºçš„å¯¹è±¡çš„åŸå‹ã€‚** ä½¿ç”¨åŸå‹å¯¹è±¡çš„å¥½å¤„æ˜¯ï¼šåœ¨å®ƒä¸Šé¢å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•å¯ä»¥è¢«å¯¹è±¡å®ä¾‹å…±äº«ã€‚åŸæ¥åœ¨æ„é€ å‡½æ•°ä¸­ç›´æ¥èµ‹å€¼ç»™å¯¹è±¡å®ä¾‹çš„å€¼ï¼Œå¯ä»¥ç›´æ¥èµ‹å€¼ç»™å®ƒä»¬çš„åŸå‹ï¼Œ å¦‚ä¸‹æ‰€ç¤ºï¼š

```javascript
function Person() {}
Person.prototype.name = "Jin";
Person.prototype.age = 18;
Person.prototype.jon = "Software Engineer";
Person.prototype.sayNmae = function () {
  consoel.log(this.name);
};

let person1 = new Person();
let person2 = new Person();
person1.sayName(); //Jin
person2.sayName(); //Jin
console.log(person1.sayName == person2.sayName); // true
```

&emsp;&emsp;åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œ æ‰€æœ‰çš„å±æ€§ä»¥åŠ `sayName() `æ–¹æ³•éƒ½ç›´æ¥æ·»åŠ åˆ°äº† `Person `çš„ `prototype `å±æ€§ä¸Šï¼Œè€Œæ„é€ å‡½æ•°ä½“ä¸­ä»€ä¹ˆä¹Ÿæ²¡æœ‰ã€‚è¿™æ ·å­å®šä¹‰ä»¥åï¼Œ è°ƒç”¨æ„é€ å‡½æ•°åˆ›å»ºçš„æ–°å¯¹è±¡ä»ç„¶æ‹¥æœ‰ç›¸åº”çš„å±æ€§å’Œæ–¹æ³•ã€‚**ä¸æ„é€ å‡½æ•°æ¨¡å¼ä¸åŒï¼Œ ä½¿ç”¨è¿™ç§åŸå‹æ¨¡å¼å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•æ˜¯ç”±æ‰€æœ‰å®ä¾‹å…±äº«çš„ã€‚** å› æ­¤ `person1 `å’Œ `person2 `è®¿é—®çš„éƒ½æ˜¯ç›¸åŒçš„å±æ€§å’Œç›¸åŒçš„ `sayName() `å‡½æ•°ã€‚

## ç†è§£ä¸€ä¸‹ ECMAScript ä¸­çš„åŸå‹

### **ç†è§£åŸå‹**

&emsp;&emsp;<span style="color:red;margin-left:30px">ä¸è®ºä½•æ—¶ï¼Œåªè¦åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œ å°±ä¼šæŒ‰ç…§ç‰¹å®šçš„è§„åˆ™ä¸ºè¿™ä¸ªå‡½æ•°åˆ›å»ºä¸€ä¸ª prototype å±æ€§ ï¼ˆæŒ‡å‘åŸå‹å¯¹è±¡ï¼‰ã€‚</span>é»˜è®¤æƒ…å†µä¸‹ï¼Œ æ‰€æœ‰åŸå‹å¯¹è±¡ä¼šè‡ªåŠ¨è·å¾—ä¸€ä¸ªåä¸º `constructor `çš„å±æ€§ï¼Œ æŒ‡å›ä¸ä¹‹å…³è”çš„æ„é€ å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œ `Person.prototype.constructor` å°±æŒ‡å‘ `Person`ã€‚

&emsp;&emsp;åœ¨æˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªæ„é€ å‡½æ•°çš„æ—¶å€™ï¼Œ åŸå‹å¯¹è±¡é»˜è®¤åªä¼šè·å¾— `constructor `å±æ€§ï¼Œ å…¶ä»–çš„æ‰€æœ‰æ–¹æ³•éƒ½ç»§æ‰¿è‡ª `Object`ã€‚ æ¯æ¬¡è°ƒç”¨æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹çš„æ—¶å€™ï¼Œ è¿™ä¸ªå®ä¾‹å†…éƒ¨çš„ `[[Prototype]]` æŒ‡é’ˆå°±è¢«èµ‹å€¼ä¸ºæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚è„šæœ¬ä¸­æ²¡æœ‰è®¿é—®è¿™ä¸ª `[[ Prototype ]] `ç‰¹æ€§çš„æ ‡å‡†æ–¹å¼ï¼Œ **ä½†æ˜¯åœ¨ Firefox, Safari å’Œ Chrome ä¸­ä¼šåœ¨æ¯ä¸ªå¯¹è±¡ä¸Šæš´éœ²`__proto__ `å±æ€§ï¼Œ é€šè¿‡è¿™ä¸ªå±æ€§å¯ä»¥è®¿é—®å¯¹è±¡çš„åŸå‹ã€‚** ä¸»è¦ç†è§£çš„ä¸€ç‚¹æ˜¯ï¼Œ å®ä¾‹ä¸æ„é€ å‡½æ•°çš„åŸå‹ä¹‹é—´æœ‰ç€ç›´æ¥çš„è”ç³»ï¼Œä½†å®ä¾‹å’Œæ„é€ å‡½æ•°ä¹‹é—´æ²¡æœ‰ã€‚

ä¸¾ä¸ª ğŸŒ° ï¼š

```javascript
1ã€åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°
function Person() {} // å£°æ˜ä¸€ä¸ªæ„é€ å‡½æ•°
let Person = function() {}  // æˆ–è€…ä½¿ç”¨å‡½æ•°å£°æ˜åˆ›å»º

2ã€è¿™ä¸ªæ„é€ å‡½æ•°å°±æœ‰äº†ä¸€ä¸ªä¸ä¹‹ç®¡ç†çš„åŸå‹å¯¹è±¡ Person.prototype
console.log(Person.prototype)
// {
//	constructor: Æ’ Person()
//	[[Prototype]]: Object
// }

3ã€è¿™ä¸ªåŸå‹å¯¹è±¡æœ‰ä¸ªconstructorå±æ€§æŒ‡å›æ„é€ å‡½æ•°
console.log(Person.prototype.constructor == Person); //true

4ã€æ­£å¸¸çš„åŸå‹é“¾éƒ½ä¼šç»ˆæ­¢äº Object çš„åŸå‹å¯¹è±¡
console.log(Person.prototype.__proto__ === Object.prototype); //true
console.log(Person.prototype.__proto__.constructor === Object); // true
console.log(Person.prototype.__proto__.__proto__ === null); // true

5ã€ æ„é€ å‡½æ•°ã€åŸå‹å¯¹è±¡ã€å®ä¾‹ æ˜¯3ä¸ªå®Œå…¨ä¸åŒçš„å¯¹è±¡
console.log(person1 !== Person); // true
console.log(person1 !== Person.prototype); // true
console.log(Person.prototype !== Person); // true

6ã€å®ä¾‹é€šè¿‡ __prototype__ é“¾æ¥åˆ°åŸå‹å¯¹è±¡ï¼Œ å®é™…ä¸ŠæŒ‡å‘éšè—çš„ç‰¹æ€§[[Prototype]]
   æ„é€ å‡½æ•°é€šè¿‡ prototype å±æ€§è¿æ¥åˆ°åŸå‹å¯¹è±¡
   å®ä¾‹ä¸æ„é€ å‡½æ•°æ²¡æœ‰ç›´æ¥è”ç³»ï¼Œ ä¸åŸå‹å¯¹è±¡æœ‰ç€ç›´æ¥è”ç³»

console.log(person1.__proto__ === Person.prototype); // true
conosle.log(person1.__proto__.constructor === Person); // true
```

&emsp;&emsp;ä¸‹é¢è¿™å¼ å›¾å¯ä»¥å¾ˆå¥½çš„è§£é‡Š æ„é€ å‡½æ•°ã€ å®ä¾‹ã€ åŸå‹å¯¹è±¡ä¸‰è€…ä¹‹é—´çš„å…³ç³»ã€‚

<div style="display:flex;justify-content:center">
	<img src="https://img-blog.csdnimg.cn/f38cc0fcd887430b90888cc090fd0e7f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6YeR5oao5oaoXw==,size_20,color_FFFFFF,t_70,g_se,x_16#pic_cente" />
</div>

### **Object çš„ä¸¤ä¸ªæ–¹æ³•**

1ã€`Object.getPrototypeOf()`å–å¾—ä¸€ä¸ªå¯¹è±¡çš„åŸå‹

```javascript
console.log(Object.getPrototypeOf(person1) == Person.prototype); // true
console.log(Object.getPrototypeOf(person1).name); // "Nicholas"
```

2ã€`Object.setPrototypeOf()`å‘å®ä¾‹çš„ç§æœ‰ç‰¹æ€§ [[Prototype]] å†™å…¥ä¸€ ä¸ªæ–°å€¼ã€‚

```javascript
let biped = {
  numLegs: 2,
};
let person = {
  name: "Matt",
};
Object.setPrototypeOf(person, biped);
console.log(person.name); // Matt
console.log(person.numLegs); // 2
console.log(Object.getPrototypeOf(person) === biped); // true
```

&emsp;&emsp;**ä¸ºé¿å…ä½¿ç”¨ Object.setPrototypeOf() å¯èƒ½é€ æˆçš„æ€§èƒ½ä¸‹é™ï¼Œå¯ä»¥é€šè¿‡ Object.create() æ¥åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼ŒåŒæ—¶ä¸ºå…¶æŒ‡å®šåŸå‹ï¼š**

```javascript
let biped = {
  numLegs: 2,
};
let person = Object.create(biped);
person.name = "Matt";
console.log(person.name); // Matt
console.log(person.numLegs); // 2
console.log(Object.getPrototypeOf(person) === biped); // true
```

### **åŸå‹çš„å±‚çº§**

**è¯»å–å®ä¾‹çš„å±æ€§çš„æ—¶å€™ï¼Œå¦‚æœæ‰¾ä¸åˆ°è¯¥å±æ€§ï¼Œå°±ä¼šå»å¯»æ‰¾è¯¥å®ä¾‹çš„åŸå‹ä¸Šçš„å±æ€§ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œç»§ç»­å¯»æ‰¾åŸå‹çš„åŸå‹ç›´åˆ°æœ€é¡¶å±‚ã€‚**

```javascript
function Person() {}
Person.prototype.name = "Nicholas";
Person.prototype.age = 29;
Person.prototype.job = "Software Engineer";
Person.prototype.sayName = function () {
  console.log(this.name);
};
let person1 = new Person();
let person2 = new Person();
person1.name = "Greg";
console.log(person1.name); // "Greg" ï¼Œæ¥è‡ªå®ä¾‹
console.log(person2.name); // "Nicholas"
```

&emsp;&emsp;ä¸Šè¿° ğŸŒ° ä¸­ï¼Œ `person1 `çš„ `name `å±æ€§é®è”½äº†åŸå‹å¯¹è±¡ä¸Šçš„åŒåå±æ€§ï¼Œæ‰€ä»¥è¿”å›äº† `Greg`, è€Œ è®¿é—® `person2 `çš„ `name`å±æ€§çš„æ—¶å€™ï¼Œ é¦–å…ˆåœ¨è¿™ä¸ªå®ä¾‹ä¸Šæœç´¢è¿™ä¸ªå±æ€§ï¼Œæ²¡æœ‰æœç´¢åˆ°å°±å»æ‰¾ä¸ªè¿™ä¸ªå®ä¾‹çš„åŸå‹å¯¹è±¡ä¸Šæœ‰æ²¡æœ‰ï¼Œ è¿™é‡Œæœ‰å°±è¿”å›äº† `Nicholas `å€¼ï¼Œ å¦‚æœéƒ½æ²¡æœ‰åˆ™ç»§ç»­å»è®¿é—®åŸå‹çš„åŸå‹ï¼Œ ä¸€ç›´åˆ°æœ€é¡¶å±‚ `Object`çš„åŸå‹ï¼Œ è¿”å›`null`

### **åŸå‹å’Œ in æ“ä½œç¬¦**

&emsp;&emsp;åªè¦é€šè¿‡å¯¹è±¡å¯ä»¥è®¿é—®ï¼Œ `in `æ“ä½œç¬¦å°±è¿”å› `true `ï¼Œè€Œ `hasOwnProperty()` åªæœ‰å±æ€§å­˜åœ¨äºå®ä¾‹ä¸Šæ—¶æ‰è¿”å› `true `ã€‚å› æ­¤ï¼Œåªè¦ `in` æ“ä½œç¬¦è¿”å› `true `ä¸” `hasOwnProperty()` è¿”å› `false `ï¼Œå°±è¯´æ˜è¯¥å±æ€§æ˜¯ä¸€ä¸ªåŸå‹å±æ€§ã€‚ ğŸŒ°

```javascript
function Person() {}
Person.prototype.name = "Nicholas";
Person.prototype.age = 29;
Person.prototype.job = "Software Engineer";
Person.prototype.sayName = function () {
  console.log(this.name);
};
let person1 = new Person();
let person2 = new Person();
console.log(person1.hasOwnProperty("name")); // false
console.log("name" in person1); // true
person1.name = "Greg";
console.log(person1.name); // "Greg"ï¼Œæ¥è‡ªå®ä¾‹
console.log(person1.hasOwnProperty("name")); // true
console.log("name" in person1); // true
console.log(person2.name); // "Nicholas"ï¼Œæ¥è‡ªåŸå‹
console.log(person2.hasOwnProperty("name")); // false
console.log("name" in person2); // true
delete person1.name;
console.log(person1.name); // "Nicholas"ï¼Œæ¥è‡ªåŸå‹
console.log(person1.hasOwnProperty("name")); // false
console.log("name" in person1); // true
```

### **å¯¹è±¡è¿­ä»£**

&emsp;&emsp;åœ¨`JavaScript`æœ‰å²ä»¥æ¥å¤§éƒ¨åˆ†æ—¶é—´é‡Œï¼Œ è¿­ä»£å¯¹è±¡å¯¹è±¡å±æ€§éƒ½æ˜¯ä¸€ä¸ªéš¾é¢˜ã€‚ ECMAScript 2017 æ–°å¢ä¸¤ä¸ªé™æ€æ–¹æ³•ï¼Œ ç”¨äºå°†å¯¹è±¡å†…å®¹è½¬æ¢ä¸ºåºåˆ—åŒ–çš„â€”â€”æ›´é‡è¦çš„æ˜¯å¯è¿­ä»£çš„â€”â€”æ ¼å¼ã€‚å®ƒä»¬åˆ†åˆ«æ˜¯ `Object.values()`å’Œ `Object.entries()`ï¼Œ æ¥å—ä¸€ä¸ªå¯¹è±¡ï¼Œè¿”å›å®ƒä»¬å†…å®¹çš„æ•°ç»„ã€‚

&emsp;&emsp;å‰è€…è¿”å›å¯¹è±¡å€¼çš„æ•°ç»„ï¼Œ åè€…è¿”å›é”®/å€¼å¯¹çš„æ•°ç»„ã€‚

```javascript
const obj = {
    name: 'JIN',
    age: 18,
    job: 'Software Enginner',
    sayName: function () {
        console.log(this.name);
    }
}

console.log(Object.values(obj));
// [ 'JIN', 18, 'Software Enginner', [Function: sayName] ]

console.log(Object.entries(obj));
//
[
  [ 'name', 'JIN' ],
  [ 'age', 18 ],
  [ 'job', 'Software Enginner' ],
  [ 'sayName', [Function: sayName] ]
]
```

&emsp;&emsp;tip: ä¸¤è€…éƒ½æ˜¯æ‰§è¡Œå¯¹è±¡çš„æµ…å¤åˆ¶

### **åŸå‹è¯­æ³•**

```javascript
function Person() {}
Person.prototype = {
  name: "Nicholas",
  age: 29,
  job: "Software Engineer",
  sayName() {
    console.log(this.name);
  },
};
```

&emsp;&emsp;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ `Person.prototype` è¢«è®¾ç½®ä¸ºç­‰äºä¸€ä¸ªé€šè¿‡å¯¹è±¡å­—é¢é‡åˆ›å»ºçš„æ–°å¯¹è±¡ã€‚æœ€ç»ˆç»“æœæ˜¯ä¸€æ ·çš„ï¼Œåªæœ‰ä¸€ä¸ªé—®é¢˜ï¼šè¿™æ ·é‡å†™ä¹‹åï¼Œ` Person.prototype` çš„ `constructor `å±æ€§å°±ä¸æŒ‡å‘ `Person`äº†ã€‚

æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™ï¼š

```javascript
function Person() {}
Person.prototype = {
  constructor: Person,
  name: "Nicholas",
  age: 29,
  job: "Software Engineer",
  sayName() {
    console.log(this.name);
  },
};
```

### **åŸå‹æ¨¡å¼çš„é—®é¢˜**

1ã€å¼±åŒ–äº†å‘æ„é€ å‡½æ•°ä¼ é€’åˆå§‹åŒ–å‚æ•°çš„èƒ½åŠ›ï¼Œ ä¼šå¯¼è‡´æ‰€æœ‰å®ä¾‹é»˜è®¤éƒ½å–å¾—ç›¸åŒçš„å±æ€§å€¼ã€‚

2ã€åŸå‹ä¸Šæ‰€æœ‰çš„å±æ€§åœ¨å®ä¾‹ä¹‹é—´æ˜¯å…±äº«çš„ã€‚è¿™å¯èƒ½ä¼šé€ æˆä¸€äº›é—®é¢˜ã€‚

&emsp;&emsp;ä¸¾ä¸ª ğŸŒ°

```javascript
function Person() {}
Person.prototype = {
  constructor: Person,
  friends: ["JIN", "TONG"],
};
let person1 = new Person();
let person2 = new Person();
person1.friends.push("Jenny");

console.log(person1.friends); //['JIN', 'TONG', 'Jenny']
console.log(person2.friends); //['JIN', 'TONG', 'Jenny']
```

&emsp;&emsp;ä¸Šè¿°æƒ…å†µä¸­,å¦‚æœæœ‰æ„åœ¨å¤šä¸ªå®ä¾‹ä¹‹é—´å…±äº«æ•°ç»„çš„è¯æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œ ä½†æ˜¯ä¸æ˜¯çš„è¯å°±ä¼šäº§ç”Ÿæ•°æ®çš„é”™è¯¯ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œ ä¸åŒçš„å®ä¾‹åº”è¯¥æœ‰å±äºè‡ªå·±çš„å±æ€§å‰¯æœ¬ã€‚ è¿™ä¹Ÿæ˜¯é€šå¸¸å®é™…å¼€å‘ä¸­ä¸å•ç‹¬ä½¿ç”¨åŸå‹æ¨¡å¼çš„åŸå› ã€‚ä¸å•ç‹¬ä½¿ç”¨åŸå‹æ¨¡å¼çš„åŸå› ã€‚
